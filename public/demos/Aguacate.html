<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aguacate 3D con THREE.js</title>
    <style>
      html,
      body {
        margin: 0;
        height: 100%;
        overflow: hidden;
        background: radial-gradient(circle at 20% 10%, #1f2f22 0%, #0b140d 70%);
      }

      canvas {
        display: block;
      }

      .label {
        position: fixed;
        top: 14px;
        left: 14px;
        padding: 8px 10px;
        border-radius: 10px;
        color: #ebf7e8;
        font-family: Arial, sans-serif;
        font-size: 13px;
        background: rgba(10, 20, 12, 0.58);
        border: 1px solid rgba(235, 247, 232, 0.2);
        user-select: none;
      }
    </style>
  </head>
  <body>
    <div class="label">Aguacate 3D Â· Arrastra para rotar</div>
  </body>

  <script type="importmap">
    {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.180.0/build/three.module.js",
        "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.180.0/examples/jsm/"
      }
    }
  </script>

  <script type="module">
    import * as THREE from "three";
    import { OrbitControls } from "three/addons/controls/OrbitControls.js";

    const scene = new THREE.Scene();
    scene.fog = new THREE.Fog(0x0b140d, 14, 26);

    const camera = new THREE.PerspectiveCamera(
      60,
      window.innerWidth / window.innerHeight,
      0.1,
      100,
    );
    camera.position.set(4.4, 2.8, 5.8);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.shadowMap.enabled = true;
    renderer.shadowMap.type = THREE.PCFSoftShadowMap;
    document.body.appendChild(renderer.domElement);

    const ambient = new THREE.AmbientLight(0xffffff, 0.52);
    scene.add(ambient);

    const sun = new THREE.DirectionalLight(0xffffff, 0.88);
    sun.position.set(5, 7, 4);
    sun.castShadow = true;
    sun.shadow.mapSize.set(1024, 1024);
    scene.add(sun);

    const rim = new THREE.DirectionalLight(0x9dd18f, 0.28);
    rim.position.set(-4, 3, -4);
    scene.add(rim);

    const ground = new THREE.Mesh(
      new THREE.PlaneGeometry(30, 30),
      new THREE.MeshStandardMaterial({ color: 0x1b2a1d, roughness: 0.95 }),
    );
    ground.rotation.x = -Math.PI / 2;
    ground.position.y = -1.2;
    ground.receiveShadow = true;
    scene.add(ground);

    const avocado = new THREE.Group();

    const skinMaterial = new THREE.MeshStandardMaterial({
      color: 0x3b5f2f,
      roughness: 0.82,
      metalness: 0.03,
    });
    const fleshMaterial = new THREE.MeshStandardMaterial({
      color: 0xc8df82,
      roughness: 0.62,
      metalness: 0.02,
    });
    const pitMaterial = new THREE.MeshStandardMaterial({
      color: 0x6f4524,
      roughness: 0.72,
      metalness: 0.03,
    });

    const outer = new THREE.Mesh(new THREE.SphereGeometry(1.25, 48, 48), skinMaterial);
    outer.scale.set(0.9, 1.25, 0.8);
    outer.castShadow = true;
    avocado.add(outer);

    const inner = new THREE.Mesh(new THREE.SphereGeometry(1.02, 48, 48), fleshMaterial);
    inner.scale.set(0.83, 1.13, 0.74);
    inner.position.z = 0.13;
    inner.castShadow = true;
    avocado.add(inner);

    const cavity = new THREE.Mesh(
      new THREE.SphereGeometry(0.47, 32, 32),
      new THREE.MeshStandardMaterial({ color: 0xa7bf62, roughness: 0.67, metalness: 0.02 }),
    );
    cavity.position.set(0, -0.08, 0.45);
    cavity.scale.set(1, 1.08, 0.65);
    avocado.add(cavity);

    const pit = new THREE.Mesh(new THREE.SphereGeometry(0.36, 36, 36), pitMaterial);
    pit.position.set(0, -0.1, 0.5);
    pit.castShadow = true;
    avocado.add(pit);

    avocado.rotation.y = 0.35;
    avocado.position.y = 0.2;
    scene.add(avocado);

    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.08;
    controls.minDistance = 3;
    controls.maxDistance = 14;
    controls.target.set(0, 0.2, 0);

    window.addEventListener("resize", () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });

    const clock = new THREE.Clock();

    function animate() {
      requestAnimationFrame(animate);

      const t = clock.getElapsedTime();
      avocado.rotation.y = 0.35 + Math.sin(t * 0.45) * 0.08;
      avocado.position.y = 0.2 + Math.sin(t * 1.3) * 0.03;

      controls.update();
      renderer.render(scene, camera);
    }

    animate();
  </script>
</html>